# ESMValTool
# recipe_ipccwg1ar6ch3_modes.yml

# --------------------------------
# Note: at least 10 models per experiment and 15 years long simulations
#       - otherwise the diagnostic fails
---
documentation:

  description: |
    Producing "modes" figures with code from Adam Phillips
  # Compute NAM/NAO/SAM metrics
  authors:
  #  - karmouche_soufiane
    - bock_lisa

  #references:

  #projects:
  #  - ipcc_ar6


preprocessors:

 enso:
   regrid:
      target_grid: 2x2
      scheme: linear
   multi_model_statistics:
      span: overlap
      statistics: [mean]
      exclude: [reference_dataset]

diagnostics:

  # **********************************************************************
  # IPCC WGI AR6, chap. 3
  # Sect. 3.3
  # Fig 3.39
  # **********************************************************************
  # AMV spatio-temporal properties in observations and models
  # **********************************************************************
  nam_nao_sam:
    description: IPCC AR6 Ch. 3, Fig. 3.** (sea level pressure)
    themes:
      - phys
    realms:
      - atmos
    variables:
      psl_cmip6: &var_def
        short_name: psl
        #preprocessor: ppNOLEV2
        reference_dataset: NOAACires20crv2c
        mip: Amon
        project: CMIP6
        ensemble: r1i1p1f1
        grid: gn
        start_year: 1958
        end_year: 2014
        additional_datasets:
          - {dataset: ACCESS-CM2, grid: gn, institute: CSIRO-ARCCSS, exp: historical}
          - {dataset: ACCESS-ESM1-5, grid: gn, institute: CSIRO, exp: historical}
          - {dataset: BCC-CSM2-MR, grid: gn, exp: historical}
          - {dataset: BCC-ESM1, grid: gn, exp: historical}
          - {dataset: CAMS-CSM1-0, grid: gn, exp: historical}
          - {dataset: CanESM5, exp: historical, ensemble: r(1:5)i1p1f1}
          - {dataset: CESM2, exp: historical, ensemble: r(1:5)i1p1f1}
          - {dataset: CESM2-FV2, grid: gn, institute: NCAR, exp: historical}
          - {dataset: CIESM, grid: gr, exp: historical}
          - {dataset: CNRM-CM6-1, grid: gr, ensemble: r1i1p1f2, exp: historical}
          - {dataset: MIROC6, grid: gn, ensemble: r1i1p1f1, exp: historical}
          - {dataset: AWI-CM-1-1-MR, grid: gn, institute: AWI, exp: historical}
          - {dataset: FGOALS-f3-L, grid: gr, institute: CAS, exp: historical}
          - {dataset: FGOALS-g3, grid: gn, institute: CAS, exp: historical}
          - {dataset: CMCC-CM2-SR5, grid: gn, institute: CMCC, exp: historical}
          - {dataset: CNRM-ESM2-1, grid: gr, institute: CNRM-CERFACS, ensemble: r1i1p1f2, exp: historical}
          - {dataset: MPI-ESM-1-2-HAM, grid: gn, institute: HAMMOZ-Consortium, exp: historical}
          - {dataset: IPSL-CM6A-LR, grid: gr, institute: IPSL, exp: historical}
          - {dataset: HadGEM3-GC31-LL, grid: gn, institute: MOHC, ensemble: r1i1p1f3, exp: historical}
          - {dataset: UKESM1-0-LL, grid: gn, institute: MOHC, ensemble: r1i1p1f2, exp: historical}
          - {dataset: MPI-ESM1-2-HR, grid: gn, institute: MPI-M, exp: historical}
          - {dataset: MRI-ESM2-0, grid: gn, institute: MRI, exp: historical}
          - {dataset: GISS-E2-1-G, grid: gn, institute: NASA-GISS, exp: historical}
          - {dataset: CESM2-WACCM-FV2, grid: gn, institute: NCAR, exp: historical}
          - {dataset: CESM2-WACCM, grid: gn, institute: NCAR, exp: historical}
          - {dataset: NorCPM1, grid: gn, institute: NCC, exp: historical}
          - {dataset: NorESM2-LM, grid: gn, institute: NCC, exp: historical}
          - {dataset: NESM3, grid: gn, institute: NUIST, exp: historical}
          - {dataset: SAM0-UNICON, grid: gn, institute: SNU, exp: historical}


          - {dataset: NOAACires20crv2c, project: OBS6, type: reanaly, version: v2c, tier: 2, start_year:  1958, end_year:  2014}
          - {dataset: JRA-55, project: OBS6, type: reanaly, version: 1, tier: 1, start_year:  1958, end_year:  2014}
          #- {dataset: ERA-Interim, project: OBS6, type: reanaly, version: 1, tier: 3, start_year:  1979, end_year:  2014}
          # missing obs:
          # ersstv5.sst.185401-202004.nc
          # ersst.v3b.185401-202002.nc
      psl_cmip5:
        <<: *var_def
        project: CMIP5
        ensemble: r1i1p1
        start_year: 1958
        end_year: 2005
        exp: [historical, rcp45]
        additional_datasets:
          - {dataset: ACCESS1-0}
          - {dataset: bcc-csm1-1}
          - {dataset: bcc-csm1-1-m}
          - {dataset: CanESM2}
          - {dataset: CCSM4, ensemble: r(1:5)i1p1}
          - {dataset: CNRM-CM5}
          - {dataset: CSIRO-Mk3-6-0}
          - {dataset: GFDL-CM3}
          - {dataset: GFDL-ESM2G}
          - {dataset: GFDL-ESM2M}


          - {dataset: BNU-ESM}
          - {dataset: CMCC-CESM}
          - {dataset: CMCC-CM}
          - {dataset: CNRM-CM5-2}
          - {dataset: FIO-ESM}
          - {dataset: IPSL-CM5A-MR}
          - {dataset: MIROC5}
          - {dataset: HadGEM2-CC}
          - {dataset: MPI-ESM-LR}
          - {dataset: MRI-CGCM3}
          - {dataset: GISS-E2-H-CC}
          - {dataset: GISS-E2-H}

    scripts:
      nam_nao_sam:
        script: ipccwg1ar6ch3_modes/nam_nao_sam.ncl
        start_year: 1958
        end_year: 2014

