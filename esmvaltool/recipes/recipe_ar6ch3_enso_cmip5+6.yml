# ESMValTool
# recipe_ar6ch3_enso.yml
---
documentation:

  description: |
    Producing selected figures from IPCC WGI AR6, chap. 3

  authors:
    - kosaka_yu

#  maintainer:
    
  references:
   - acknow_project

  projects:
    - ipcc_ar6

  realms:
    - atmos

  themes:
    - varmodes

  domains:
    - trop

  plot_types:
    - times
    - other

  statistics:
    - range
    - other

datasets:
  - {project: CMIP6, dataset: ACCESS-CM2, ensemble: r(1:2)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: ACCESS-ESM1-5, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: AWI-CM-1-1-MR, ensemble: r(1:5)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: AWI-ESM-1-1-LR, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: BCC-CSM2-MR, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: BCC-ESM1, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CAMS-CSM1-0, ensemble: r(1:2)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CAS-ESM2-0, ensemble: r(1:4)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CESM2, ensemble: r(1:11)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CESM2-FV2, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CESM2-WACCM, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CESM2-WACCM-FV2, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CIESM, ensemble: r(1:3)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CMCC-CM2-HR4, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CMCC-CM2-SR5, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CNRM-CM6-1, ensemble: r(1:22)i1p1f2, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CNRM-CM6-1, ensemble: r24i1p1f2, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CNRM-CM6-1-HR, ensemble: r1i1p1f2, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CNRM-ESM2-1, ensemble: r(1:5)i1p1f2, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CNRM-ESM2-1, ensemble: r(7:10)i1p1f2, grid: gr, exp: historical}
  - {project: CMIP6, dataset: CanESM5, ensemble: r(1:25)i1p2f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: CanESM5-CanOE, ensemble: r(1:3)i1p2f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: E3SM-1-0, ensemble: r(1:5)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: E3SM-1-1, ensemble: r1i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: E3SM-1-1-ECA, ensemble: r1i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3, ensemble: r(1:4)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3, ensemble: r(6:7)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3, ensemble: r9i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3, ensemble: r(11:22)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3, ensemble: r24i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3-Veg, ensemble: r(1:4)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: EC-Earth3-Veg-LR, ensemble: r1i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: FGOALS-f3-L, ensemble: r(1:3)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: FGOALS-g3, ensemble: r(1:6)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: FIO-ESM-2-0, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: GFDL-CM4, ensemble: r1i1p1f1, grid: gr1, exp: historical}
  - {project: CMIP6, dataset: GFDL-ESM4, ensemble: r(1:3)i1p1f1, grid: gr1, exp: historical}
  - {project: CMIP6, dataset: GISS-E2-1-G, ensemble: r(1:10)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: GISS-E2-1-G-CC, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: GISS-E2-1-H, ensemble: r(1:10)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: HadGEM3-GC31-LL, ensemble: r(1:4)i1p1f3, grid: gn, exp: historical}
  - {project: CMIP6, dataset: HadGEM3-GC31-MM, ensemble: r(1:2)i1p1f3, grid: gn, exp: historical}
  - {project: CMIP6, dataset: IITM-ESM, ensemble: r1i1p1f1, grid: gn, exp: historical} # missing some time segments
  - {project: CMIP6, dataset: INM-CM4-8, ensemble: r1i1p1f1, grid: gr1, exp: historical}
  - {project: CMIP6, dataset: INM-CM5-0, ensemble: r(1:10)i1p1f1, grid: gr1, exp: historical}
  - {project: CMIP6, dataset: IPSL-CM6A-LR, ensemble: r(1:32)i1p1f1, grid: gr, exp: historical}
  - {project: CMIP6, dataset: KACE-1-0-G, ensemble: r(1:3)i1p1f1, grid: gr, exp: historical}
  #- {project: CMIP6, dataset: MCM-UA-1-0, ensemble: r1i1p1f1, grid: gn, exp: historical} #preprocess failure
  - {project: CMIP6, dataset: MIROC-ES2L, ensemble: r(1:3)i1p1f2, grid: gn, exp: historical}
  - {project: CMIP6, dataset: MIROC6, ensemble: r(1:10)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: MPI-ESM-1-2-HAM, ensemble: r(1:2)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: MPI-ESM1-2-HR, ensemble: r(1:10)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: MPI-ESM1-2-LR, ensemble: r(1:10)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: MRI-ESM2-0, ensemble: r(1:5)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: NESM3, ensemble: r(1:5)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: NorCPM1, ensemble: r(1:30)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: NorESM2-LM, ensemble: r(1:3)i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: NorESM2-MM, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: SAM0-UNICON, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: TaiESM1, ensemble: r1i1p1f1, grid: gn, exp: historical}
  - {project: CMIP6, dataset: UKESM1-0-LL, ensemble: r(1:4)i1p1f2, grid: gn, exp: historical}
  - {project: CMIP6, dataset: UKESM1-0-LL, ensemble: r(5:7)i1p1f3, grid: gn, exp: historical}
  - {project: CMIP6, dataset: UKESM1-0-LL, ensemble: r(8:13)i1p1f2, grid: gn, exp: historical}
  - {project: CMIP6, dataset: UKESM1-0-LL, ensemble: r(16:19)i1p1f2, grid: gn, exp: historical}

  - {project: CMIP5, dataset: ACCESS1-0, ensemble: r1i1p1, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: ACCESS1-3, ensemble: r1i1p1, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: BNU-ESM, ensemble: r1i1p1, exp: [historical, rcp45]}
#  - {project: CMIP5, dataset: CanCM4, ensemble: r1i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r2i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r3i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r4i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r5i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r6i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r7i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r8i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r9i1p1, exp: [historical, rcp45]} #since 1961
#  - {project: CMIP5, dataset: CanCM4, ensemble: r10i1p1, exp: [historical, rcp45]} #since 1961
  - {project: CMIP5, dataset: CanESM2, ensemble: r(1:5)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: CCSM4, ensemble: r(1:5)i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: CCSM4, ensemble: r6i1p1, exp: [historical, rcp45]} #preprocessor failure
  - {project: CMIP5, dataset: CESM1-BGC, ensemble: r1i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: CESM1-CAM5-1-FV2, ensemble: r1i1p1, exp: [historical, rcp45]} #preprocessor failure
  - {project: CMIP5, dataset: CESM1-CAM5, ensemble: r(1:3)i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: CESM1-FASTCHEM, ensemble: r1i1p1, exp: [historical, rcp45]} # No RCP4.5
#  - {project: CMIP5, dataset: CESM1-WACCM, ensemble: r1i1p1, exp: [historical, rcp45]}  # No RCP4.5
#  - {project: CMIP5, dataset: CESM1-WACCM, ensemble: r2i1p1, exp: [historical, rcp45]} #since 1955
#  - {project: CMIP5, dataset: CESM1-WACCM, ensemble: r3i1p1, exp: [historical, rcp45]} #since 1955
#  - {project: CMIP5, dataset: CESM1-WACCM, ensemble: r4i1p1, exp: [historical, rcp45]} #since 1955
#  - {project: CMIP5, dataset: CMCC-CESM, ensemble: r1i1p1, exp: [historical, rcp45]}  # NO RCP4.5
  - {project: CMIP5, dataset: CMCC-CM, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: CMCC-CMS, ensemble: r1i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: CNRM-CM5-2, ensemble: r1i1p1, exp: [historical, rcp45]} # No RCP4.5
  - {project: CMIP5, dataset: CNRM-CM5, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: CSIRO-Mk3-6-0, ensemble: r(1:10)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: CSIRO-Mk3L-1-2, ensemble: r1i2p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r1i1p1, exp: [historical, rcp45]} #since 1950
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r2i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r3i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r6i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r7i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r8i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r9i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r11i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r12i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r13i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: EC-EARTH, ensemble: r14i1p1, exp: [historical, rcp45]} #no file
#  - {project: CMIP5, dataset: FGOALS-g2, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap&concetenation failure
  - {project: CMIP5, dataset: FGOALS-s2, ensemble: r(1:3)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: FIO-ESM, ensemble: r(1:3)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: GFDL-CM2p1, ensemble: r(1:10)i1p1, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: GFDL-CM3, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: GFDL-ESM2G, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: GFDL-ESM2M, ensemble: r1i1p1, exp: [historical, rcp45]}
#  - {project: CMIP5, dataset: GISS-E2-H-CC, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap
  - {project: CMIP5, dataset: GISS-E2-H, ensemble: r(1:5)i1p(1:3), exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: GISS-E2-H, ensemble: r6i1p3, exp: [historical, rcp45]} #overlap, preprocessor failure
#  - {project: CMIP5, dataset: GISS-E2-R-CC, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap
  - {project: CMIP5, dataset: GISS-E2-R, ensemble: r(1:5)i1p(1:3), exp: [historical, rcp45]}
  - {project: CMIP5, dataset: GISS-E2-R, ensemble: r6i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: GISS-E2-R, ensemble: r6i1p3, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: HadCM3, ensemble: r(1:10)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: HadGEM2-AO, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: HadGEM2-CC, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: HadGEM2-ES, ensemble: r1i1p1, exp: [historical, rcp45]}
#  - {project: CMIP5, dataset: HadGEM2-ES, ensemble: r2i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: HadGEM2-ES, ensemble: r3i1p1, exp: [historical, rcp45]} #overlap
  - {project: CMIP5, dataset: HadGEM2-ES, ensemble: r4i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: IPSL-CM5A-LR, ensemble: r(1:4)i1p1, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: IPSL-CM5A-MR, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: IPSL-CM5B-LR, ensemble: r1i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: MIROC4h, ensemble: r1i1p1, exp: [historical, rcp45]} #since 1950
#  - {project: CMIP5, dataset: MIROC4h, ensemble: r2i1p1, exp: [historical, rcp45]} #since 1950
#  - {project: CMIP5, dataset: MIROC4h, ensemble: r3i1p1, exp: [historical, rcp45]} #since 1950
#  - {project: CMIP5, dataset: MIROC5, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: MIROC5, ensemble: r2i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: MIROC5, ensemble: r3i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: MIROC5, ensemble: r4i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: MIROC5, ensemble: r5i1p1, exp: [historical, rcp45]} #overlap
  - {project: CMIP5, dataset: MIROC-ESM, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: MIROC-ESM-CHEM, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: MPI-ESM-LR, ensemble: r(1:3)i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: MPI-ESM-MR, ensemble: r(1:3)i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: MPI-ESM-P, ensemble: r1i1p1, exp: [historical, rcp45]} # No RCP4.5
  - {project: CMIP5, dataset: MRI-CGCM3, ensemble: r1i1p1, exp: [historical, rcp45]}
  - {project: CMIP5, dataset: NorESM1-M, ensemble: r1i1p1, exp: [historical, rcp45]} 
  - {project: CMIP5, dataset: NorESM1-ME, ensemble: r1i1p1, exp: [historical, rcp45]} 
#  - {project: CMIP5, dataset: bcc-csm1-1, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap
#  - {project: CMIP5, dataset: bcc-csm1-1-m, ensemble: r1i1p1, exp: [historical, rcp45]} #overlap
  - {project: CMIP5, dataset: inmcm4, ensemble: r1i1p1, exp: [historical, rcp45]}

  
preprocessors:

  pp_index:
    extract_region:
      start_longitude: 120.
      end_longitude: 280.
      start_latitude: -30.
      end_latitude: 30.
      
diagnostics:

  enso_index:
    description: define ENSO events and draw seasonality
    variables:
      ts:
        preprocessor: pp_index
        mip: Amon
        frequency: mon
        start_year: 1948
        end_year: 2014
        additional_datasets:
          - {dataset: HadISST, project: OBS, type: reanaly, version: 1, tier: 2}
          - {dataset: ERSSTv5, project: OBS, type: reanaly, version: 1, tier: 2}

    scripts:
      define_ensoindex:
        script: ar6ch3_enso/define_ensoindex.ncl
        syear: 1951
        eyear: 2010
        index: Nino3.4  # Nino3, Nino3.4, Nino4, Nino1+2, Nino3.3_LatExt, TP, EP, EP_LatExt, EEP, WEP
        detrend: True
      draw_enso_lifecycle:
        script: ar6ch3_enso/draw_lifecycle.ncl
        syear: 1951
        eyear: 2010
        detect_month: 12  # Based on December value
        detect_threshold: 0.75
        unit_detect_threshold: stdv
        duration_threshold: 0.5
        unit_duration_threshold: stdv
        ancestors: ['define_ensoindex']
      draw_enso_seasonality:
        script: ar6ch3_enso/draw_seasonality.ncl
        syear: 1951
        eyear: 2010
        ancestors: ['define_ensoindex']
