# ESMValTool
# --------------------------------
---
documentation:

  description: |
    Producing GSAT and its trend figure with code from Adam Phillips

  authors:
    - kosaka_yu
    
  #references:

  projects:
    - ipcc_ar6


preprocessors:
 temp_tr:
   regrid:
      target_grid: 5x5
      lon_offset: True
      lat_offset: True
      scheme: area_weighted

diagnostics:

  # *************************************************************************
  # IPCC WGI AR6, chap. 3
  # Sect. 3.3
  # Fig 3.5
  # *************************************************************************
  # GSAT in piControl and GSAT trends in piControl, obs and historical-ssp245
  # *************************************************************************

  gsat_pi+hist+obs:
    description: IPCC AR6 Ch. 3, Fig. 3.5
    themes:
      - phys
    realms:
      - atmos
    variables:
      tas_pi: &var_sat
        short_name: tas
        mip: Amon
        project: CMIP6
        exp: piControl
        preprocessor: temp_tr
        additional_datasets:
          - {dataset: ACCESS-CM2, grid: gn, ensemble: r1i1p1f1, start_year: 950, end_year: 1449}
          - {dataset: ACCESS-ESM1-5, grid: gn, ensemble: r1i1p1f1, start_year: 101, end_year: 600}
          #- {dataset: AWI-CM-1-1-MR, grid: gn, ensemble: r1i1p1f1, start_year: 2401, end_year: 2900}
          #- {dataset: AWI-ESM-1-1-LR, grid: gn, ensemble: r1i1p1f1, start_year: 1855, end_year: 2354}
          - {dataset: BCC-CSM2-MR, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          #- {dataset: BCC-ESM1, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: CAMS-CSM1-0, grid: gn, ensemble: r1i1p1f1, start_year: 2900, end_year: 3399}
          - {dataset: CAS-ESM2-0, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: CESM2, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: CESM2-FV2, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          #- {dataset: CESM2-WACCM, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          #- {dataset: CESM2-WACCM-FV2, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500} # preprocessor failure
          - {dataset: CIESM, grid: gr, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: CMCC-CM2-SR5, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: CNRM-CM6-1, grid: gr, ensemble: r1i1p1f2, start_year: 1850, end_year: 2349}
          #- {dataset: CNRM-CM6-1-HR, grid: gr, ensemble: r1i1p1f2, start_year: 1850, end_year: 2349}
          - {dataset: CNRM-ESM2-1, grid: gr, ensemble: r1i1p1f2, start_year: 1850, end_year: 2349}
          - {dataset: CanESM5, grid: gn, ensemble: r1i1p2f1, start_year: 5550, end_year: 6049}
          - {dataset: CanESM5-CanOE, grid: gn, ensemble: r1i1p2f1, start_year: 5550, end_year: 6049}
          - {dataset: E3SM-1-0, grid: gr, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          #- {dataset: E3SM-1-1, grid: gr, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          #- {dataset: E3SM-1-1-ECA, grid: gr, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: EC-Earth3, grid: gr, ensemble: r1i1p1f1, start_year: 2259, end_year: 2758}
          #- {dataset: EC-Earth3-LR, grid: gr, ensemble: r1i1p1f1, start_year: 2219, end_year: 2718}
          - {dataset: EC-Earth3-Veg, grid: gr, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: EC-Earth3-Veg-LR, grid: gr, ensemble: r1i1p1f1, start_year: 2300, end_year: 2799}
          #- {dataset: FGOALS-f3-L, grid: gr, ensemble: r1i1p1f1, start_year: 600, end_year: 1099}
          - {dataset: FGOALS-g3, grid: gn, ensemble: r1i1p1f1, start_year: 200, end_year: 699}
          - {dataset: FIO-ESM-2-0, grid: gn, ensemble: r1i1p1f1, start_year: 301, end_year: 800}
          - {dataset: GFDL-CM4, grid: gr1, ensemble: r1i1p1f1, start_year: 151, end_year: 650}
          - {dataset: GFDL-ESM4, grid: gr1, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: GISS-E2-1-G, grid: gn, ensemble: r1i1p1f1, start_year: 4150, end_year: 4649}
          #- {dataset: GISS-E2-1-G-CC, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: GISS-E2-1-H, grid: gn, ensemble: r1i1p1f1, start_year: 3180, end_year: 3679}
          #- {dataset: GISS-E2-2-G, grid: gn, ensemble: r1i1p1f1, start_year: 2000, end_year: 2499}
          - {dataset: HadGEM3-GC31-LL, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: HadGEM3-GC31-MM, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          #- {dataset: IITM-ESM, grid: gn, ensemble: r1i1p1f1, start_year: 1926, end_year: 2425}
          - {dataset: INM-CM4-8, grid: gr1, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: INM-CM5-0, grid: gr1, ensemble: r1i1p1f1, start_year: 1996, end_year: 2495}
          - {dataset: IPSL-CM6A-LR, grid: gr, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          #- {dataset: KACE-1-0-G, grid: gr, ensemble: r1i1p1f1, start_year: 2000, end_year: 2499}
          #- {dataset: KIOST-ESM, grid: gr1, ensemble: r1i1p1f1, start_year: 2689, end_year: 3188}
          - {dataset: MCM-UA-1-0, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: MIROC-ES2L, grid: gn, ensemble: r1i1p1f2, start_year: 1850, end_year: 2349}
          - {dataset: MIROC6, grid: gn, ensemble: r1i1p1f1, start_year: 3200, end_year: 3699}
          - {dataset: MPI-ESM-1-2-HAM, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: MPI-ESM1-2-HR, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: MPI-ESM1-2-LR, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: MRI-ESM2-0, grid: gn, ensemble: r1i1p1f1, start_year: 1850, end_year: 2349}
          - {dataset: NESM3, grid: gn, ensemble: r1i1p1f1, start_year: 500, end_year: 999}
          - {dataset: NorCPM1, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          #- {dataset: NorESM1-F, grid: gn, ensemble: r1i1p1f1, start_year: 1501, end_year: 2000}
          #- {dataset: NorESM2-LM, grid: gn, ensemble: r1i1p1f1, start_year: 1600, end_year: 2099} #preprocessor failure
          - {dataset: NorESM2-MM, grid: gn, ensemble: r1i1p1f1, start_year: 1200, end_year: 1699}
          - {dataset: SAM0-UNICON, grid: gn, ensemble: r1i1p1f1, start_year: 1, end_year: 500}
          - {dataset: TaiESM1, grid: gn, ensemble: r1i1p1f1, start_year: 201, end_year: 700}
          - {dataset: UKESM1-0-LL, grid: gn, ensemble: r1i1p1f2, start_year: 1960, end_year: 2459}

      tas_hist:
        short_name: tas
        mip: Amon
        project: CMIP6
        grid: gn
        exp: [historical, ssp245]
        start_year: 1850
        end_year: 2019
        preprocessor: temp_tr
        additional_datasets:
          - {dataset: ACCESS-CM2, ensemble: r(1:2)i1p1f1, grid: gn}
          - {dataset: ACCESS-ESM1-5, ensemble: r(1:10)i1p1f1, grid: gn}
          #- {dataset: AWI-CM-1-1-MR, ensemble: r1i1p1f1, grid: gn} # preprocessor failure
          - {dataset: BCC-CSM2-MR, ensemble: r1i1p1f1, grid: gn}
          - {dataset: CAMS-CSM1-0, ensemble: r(1:2)i1p1f1, grid: gn}
          - {dataset: CESM2, ensemble: r(1:4)i1p1f1, grid: gn}
          - {dataset: CESM2, ensemble: r10i1p1f1, grid: gn}
          - {dataset: CESM2-WACCM, ensemble: r(1:3)i1p1f1, grid: gn}
          - {dataset: CIESM, ensemble: r1i1p1f1, grid: gr}
          - {dataset: CMCC-CM2-SR5, ensemble: r1i1p1f1, grid: gn}
          - {dataset: CNRM-CM6-1, ensemble: r(1:10)i1p1f2, grid: gr}
          - {dataset: CNRM-ESM2-1, ensemble: r(1:5)i1p1f2, grid: gr}
          - {dataset: CNRM-ESM2-1, ensemble: r(7:10)i1p1f2, grid: gr}
          - {dataset: CanESM5, ensemble: r(1:25)i1p2f1, grid: gn}
          - {dataset: CanESM5-CanOE, ensemble: r(1:3)i1p2f1, grid: gn}
          - {dataset: EC-Earth3, ensemble: r(1:2)i1p1f1, grid: gr}
          - {dataset: EC-Earth3, ensemble: r4i1p1f1, grid: gr}
          - {dataset: EC-Earth3, ensemble: r(6:7)i1p1f1, grid: gr}
          - {dataset: EC-Earth3, ensemble: r9i1p1f1, grid: gr}
          - {dataset: EC-Earth3, ensemble: r(11:22)i1p1f1, grid: gr}
          - {dataset: EC-Earth3, ensemble: r24i1p1f1, grid: gr}
          - {dataset: EC-Earth3-Veg, ensemble: r(1:5)i1p1f1, grid: gr}
          #- {dataset: FGOALS-f3-L, ensemble: r1i1p1f1, grid: gr} # preprocessor failure
          - {dataset: FGOALS-g3, ensemble: r(1:4)i1p1f1, grid: gn}
          - {dataset: FIO-ESM-2-0, ensemble: r(1:3)i1p1f1, grid: gn}
          - {dataset: GFDL-CM4, ensemble: r1i1p1f1, grid: gr1}
          - {dataset: GFDL-ESM4, ensemble: r(1:3)i1p1f1, grid: gr1}
          - {dataset: GISS-E2-1-G, ensemble: r(1:10)i1p1f2, grid: gn}
          - {dataset: HadGEM3-GC31-LL, ensemble: r(1:4)i1p1f3, grid: gn}
          #- {dataset: IITM-ESM, ensemble: r1i1p1f1, grid: gn}
          - {dataset: INM-CM4-8, ensemble: r1i1p1f1, grid: gr1}
          - {dataset: INM-CM5-0, ensemble: r1i1p1f1, grid: gr1}
          - {dataset: IPSL-CM6A-LR, ensemble: r(1:6)i1p1f1, grid: gr}
          - {dataset: IPSL-CM6A-LR, ensemble: r(10:11)i1p1f1, grid: gr}
          - {dataset: IPSL-CM6A-LR, ensemble: r14i1p1f1, grid: gr}
          - {dataset: IPSL-CM6A-LR, ensemble: r22i1p1f1, grid: gr}
          - {dataset: IPSL-CM6A-LR, ensemble: r25i1p1f1, grid: gr}
          #- {dataset: KACE-1-0-G, grid: gr, ensemble: r(1:3)i1p1f1}
          #- {dataset: KIOST-ESM, grid: gr1, ensemble: r1i1p1f1}
          - {dataset: MCM-UA-1-0, ensemble: r1i1p1f2, grid: gn}
          - {dataset: MIROC-ES2L, ensemble: r1i1p1f2, grid: gn}
          - {dataset: MIROC6, ensemble: r(1:10)i1p1f1, grid: gn}
          - {dataset: MPI-ESM1-2-HR, ensemble: r(1:2)i1p1f1, grid: gn}
          - {dataset: MPI-ESM1-2-LR, ensemble: r(1:10)i1p1f1, grid: gn}
          - {dataset: MRI-ESM2-0, ensemble: r(1:5)i1p1f1, grid: gn}
          - {dataset: NESM3, ensemble: r(1:2)i1p1f1, grid: gn}
          #- {dataset: NorESM2-LM, ensemble: r(1:3)i1p1f1, grid: gn}
          - {dataset: NorESM2-LM, ensemble: r(2:3)i1p1f1, grid: gn}
          - {dataset: NorESM2-MM, ensemble: r(1:2)i1p1f1, grid: gn}
          - {dataset: TaiESM1, grid: gn, ensemble: r1i1p1f1}
          - {dataset: UKESM1-0-LL, ensemble: r(1:4)i1p1f2, grid: gn}
          - {dataset: UKESM1-0-LL, ensemble: r8i1p1f2, grid: gn}
          - {dataset: UKESM1-0-LL, ensemble: r13i1p1f2, grid: gn}

#      tasa_obs:
#        short_name: tasa
#        mip: Amon
#        project: OBS
#        start_year: 1850
#        end_year: 2019
#        additional_datasets:      
#          - {dataset: NOAAGlobalTemp-Interim, project: OBS, type: ground, version: v5, tier: 2}
#          - {dataset: Kadow, project: OBS, type: median, version: 4.6.0.0, tier: 2}

      tasaga_obs:
        short_name: tasaga
        mip: Amon
        project: OBS
        start_year: 1850
        end_year: 2019
        additional_datasets:      
          - {dataset: HadCRUT5, project: OBS, type: mean, version: 5.0.1.0, tier: 2}
          #- {dataset: GISTEMP, project: OBS, type: ground, version: v4, tier: 2} # begins in 1880
          - {dataset: BerkeleyEarth, project: OBS, type: ground, version: 1, tier: 2}
          - {dataset: CowtanWay, project: OBS, type: median, version: version2.0, tier: 2}
          
    scripts:
      gsat_pi_hist_obs:
        script: ipccwg1ar6ch3_gsat_pi/gsat_pi_hist_obs.ncl
