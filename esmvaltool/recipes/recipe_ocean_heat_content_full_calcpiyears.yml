# ESMValTool
# recipe_ocean_heat_content_full_calcpiyears.yml
# Calculate the years from the pi control.
---
documentation:
  description: |
    Recipe to produce several figures for IPCC WG1 chapter 3,
    including
      ohc_timeseries, (figure 3.23)
      ohu_timeseries, (figure 3.25)
      halosteric_sea_level, (figure 3.27)
      thermosteric_sea_level (figure 3.28)

    unfortunately, a lot of the procesing needs to be done in the diagnostic script,
    so there's only limited preprocessing done here.

  authors:
    - demora_lee

  references:
    - demora2018gmd


  projects:
    - ukesm


preprocessors:

    prep_annual:
      annual_statistics:
        operator: mean
      regrid_time:
        frequency: yr
        #      regrid:
        # target_grid: 5x5
        # scheme: linear





diagnostics:
  diag_ohc:
    variables:
      thetao:
        short_name: thetao
        preprocessor: prep_annual
        mip: Omon
        grid: gn
        project: CMIP6
        additional_datasets: &dataset_anchor
          - {project: CMIP6, mip: Omon, grid: gn, institute: AWI  ,     dataset: AWI-CM-1-1-M, exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: BCC,     dataset: BCC-CSM2-MR,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: BCC,     dataset: BCC-ESM1,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: CAMS,     dataset: CAMS-CSM1-0,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: CCCma,     dataset: CanESM5,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: CSIRO-ARCCSS,  dataset: ACCESS-CM2,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: IPSL,     dataset: IPSL-CM6A-LR,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: MIROC,     dataset: MIROC6,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: MOHC,     dataset: HadGEM3-GC31-LL,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: MOHC,     dataset: HadGEM3-GC31-MM,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NASA-GISS,     dataset: GISS-E2-1-G,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NCAR,     dataset: CESM2,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NCAR,     dataset: CESM2-WACCM,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NOAA-GFDL,     dataset: GFDL-CM4,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NOAA-GFDL,     dataset: GFDL-ESM4,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NUIST,     dataset: NESM3,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: UA,     dataset: MCM-UA-1-0,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}

          - {project: CMIP6, mip: Omon, grid: gn, institute: CNRM-CERFACS,     dataset: CNRM-CM6-1,       exp: historical, ensemble: r1i1p1f2, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: CNRM-CERFACS,     dataset: CNRM-ESM2-1,       exp: historical, ensemble: r1i1p1f2, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: MIROC,     dataset: MIROC-ES2L,       exp: historical, ensemble: r1i1p1f2, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: MOHC,     dataset:UKESM1-0-LL,       exp: historical, ensemble: r1i1p1f2, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NASA-GISS,     dataset: GISS-E2-1-G,       exp: historical, ensemble: r1i1p1f2, start_year: 2013, end_year: 2014}
          - {project: CMIP6, mip: Omon, grid: gn, institute: NASA-GISS,     dataset: MCM-UA-1-0,       exp: historical, ensemble: r1i1p1f1, start_year: 2013, end_year: 2014}

#           # -----------
#           #  ACCESS-CM2 historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 ACCESS-CM2 r1i1p1f1
#           # ACCESS-CM2 :     [1860, 2014] is [960, 1114]
#           - {project: CMIP6, mip: Omon, grid: gn, institute: CSIRO-ARCCSS, dataset: ACCESS-CM2,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           - {project: CMIP6, mip: Omon, grid: gn, institute: CSIRO-ARCCSS, dataset: ACCESS-CM2,     exp: piControl,  ensemble: r1i1p1f1, start_year: 960, end_year: 1114}
#
#           # -----------
#           #  ACCESS-ESM1-5 historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 ACCESS-ESM1-5 r1i1p1f1
#           # ACCESS-ESM1-5 :  [1860, 2014] is [171, 325]
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: ACCESS-ESM1-5,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: ACCESS-ESM1-5,     exp: piControl,  ensemble: r1i1p1f1, start_year: 171, end_year: 325}
#           # NO so ON JASMIN (2020-09-18)
#
#           # -----------
#           #  CESM2 historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 CESM2 r1i1p1f1
#           # CESM2 :  [1860, 2014] is [611, 765]
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: CESM2,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: CESM2,     exp: piControl,  ensemble: r1i1p1f1, start_year: 611, end_year: 765}
#
#           # -----------
#           #  CIESM historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 CIESM r1i1p1f1
#           # CIESM :  [1860, 2014] is [11, 165]
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: CIESM,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: CIESM,     exp: piControl,  ensemble: r1i1p1f1, start_year: 11, end_year: 165}
#           # NO so ON JASMIN (2020-09-18)
#
#           # -----------
#           #  HadGEM3-GC31-LL historical r1i1p1f3 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 HadGEM3-GC31-LL r1i1p1f1
#           # HadGEM3-GC31-LL :        [1860, 2014] is [1860, 2014]
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: HadGEM3-GC31-LL,     exp: historical, ensemble: r1i1p1f3, start_year: 1860, end_year: 2014}
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: HadGEM3-GC31-LL,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#
#           # -----------
#           #  MPI-ESM1-2-HR historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 MPI-ESM1-2-HR r1i1p1f1
#           # MPI-ESM1-2-HR :  [1860, 2014] is [1860, 2014]
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: MPI-ESM1-2-HR,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: MPI-ESM1-2-HR,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # NOT ON JASMIN (2020-09-18)
#
#           # -----------
#           #  MPI-ESM1-2-LR historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 MPI-ESM1-2-LR r1i1p1f1
#           # MPI-ESM1-2-LR :  [1860, 2014] is [1860, 2014]
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: MPI-ESM1-2-LR,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: MPI-ESM1-2-LR,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # NO picontrol so ON JASMIN (2020-09-18)
#
#           # -----------
#           #  NorESM2-LM historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 NorESM2-LM r1i1p1f1
#           # NorESM2-LM :     [1860, 2014] is [1660, 1814]
#           # - {project: CMIP6, mip: Omon, grid: gr, dataset: NorESM2-LM,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gr, dataset: NorESM2-LM,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1660, end_year: 1814}
#           # NO picontrol so ON JASMIN (2020-09-18)
#
#           # -----------
#           #  NorESM2-MM historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 NorESM2-MM r1i1p1f1
#           # NorESM2-MM :     [1860, 2014] is [1261, 1415]
#           # - {project: CMIP6, mip: Omon, grid: gr, dataset: NorESM2-MM,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014,}
#           # - {project: CMIP6, mip: Omon, grid: gr, dataset: NorESM2-MM,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1261, end_year: 1415,}
#           # NO picontrol so ON JASMIN (2020-09-18)
#           #
#           # -----------
#           #  SAM0-UNICON historical r1i1p1f1 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 SAM0-UNICON r1i1p1f1
#           # SAM0-UNICON :    [1860, 2014] is [284, 438]
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: SAM0-UNICON,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
#           # - {project: CMIP6, mip: Omon, grid: gn, dataset: SAM0-UNICON,     exp: piControl,  ensemble: r1i1p1f1, start_year: 284, end_year: 438}
#           # NO thetao ON JASMIN (2020-09-18)
#           #
#           # -----------
#           #  UKESM1-0-LL historical r2i1p1f2 CMIP6 Omon
#           # Origin is: CMIP piControl CMIP6 UKESM1-0-LL r1i1p1f2
#           # UKESM1-0-LL :    [1860, 2014] is [2175, 2329]
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL,     exp: historical, ensemble: r2i1p1f2, start_year: 1860, end_year: 2014}
#           - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL,     exp: piControl,  ensemble: r1i1p1f2, start_year: 2175, end_year: 2329}
#
# ## Not registered yet      - {project: CMIP6, mip: Omon, grid: gn, dataset: CESM2-FV2}
# ## Not registered yet      - {project: CMIP6, mip: Omon, grid: gn, dataset: CESM2-WACCM-FV2}
# ## Lon/Lat bounds error      - {project: CMIP6, mip: Omon, grid: gn, dataset: FGOALS-f3-L}
# ## Coord bound error      - {project: CMIP6, mip: Omon, grid: gn, dataset: MCM-UA-1-0}
# ## Not registered yet      - {project: CMIP6, mip: Omon, grid: gn, dataset: NorCPM1, grid: gr}

      # so:
      #   short_name: so
      #   preprocessor: prep_annual
      #   additional_datasets: *dataset_anchor
      # volcellofx:
      #   short_name: volcello
      #   additional_datasets:
      #     - {project: CMIP6, mip: Ofx,  grid: gn, dataset: CESM2,     exp: historical, ensemble: r1i1p1f1, start_year: 611, end_year: 765}
      #
      # volcello:
      #   short_name: volcello
      #   preprocessor: prep_annual
      #   #additional_datasets: *dataset_anchor
      #   additional_datasets:
      #     - {project: CMIP6, mip: Omon, grid: gn, institute: CSIRO-ARCCSS, dataset: ACCESS-CM2,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
      #     - {project: CMIP6, mip: Omon, grid: gn, institute: CSIRO-ARCCSS, dataset: ACCESS-CM2,     exp: piControl,  ensemble: r1i1p1f1, start_year: 960, end_year: 1114}
      #
      #
      #     - {project: CMIP6, mip: Omon, grid: gn, dataset: HadGEM3-GC31-LL,     exp: historical, ensemble: r1i1p1f3, start_year: 1860, end_year: 2014}
      #     - {project: CMIP6, mip: Omon, grid: gn, dataset: HadGEM3-GC31-LL,     exp: piControl,  ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
      #
      #
      #     - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL,     exp: historical, ensemble: r2i1p1f2, start_year: 1860, end_year: 2014}
      #     - {project: CMIP6, mip: Omon, grid: gn, dataset: UKESM1-0-LL,     exp: piControl,  ensemble: r1i1p1f2, start_year: 2175, end_year: 2329}
      #
      #
      # areacello:
      #  short_name: areacello
      #  additional_datasets:
      #     - {project: CMIP6, mip: Ofx, grid: gn, institute: CSIRO-ARCCSS, dataset: ACCESS-CM2,     exp: historical, ensemble: r1i1p1f1, start_year: 960, end_year: 1114}
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: ACCESS-ESM1-5,     exp: historical,  ensemble: r1i1p1f1, start_year: 171, end_year: 325}
      #     - {project: CMIP6, mip: Ofx, grid: gn, dataset: CESM2,     exp: historical,  ensemble: r1i1p1f1, start_year: 611, end_year: 765}
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: CIESM,     exp: historical, ensemble: r1i1p1f1, start_year: 11, end_year: 165}
      #     - {project: CMIP6, mip: Ofx, grid: gn, dataset: HadGEM3-GC31-LL,     exp: piControl, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: MPI-ESM1-2-HR,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
      #     - {project: CMIP6, mip: Ofx, grid: gn, dataset: MPI-ESM1-2-LR,     exp: historical, ensemble: r1i1p1f1, start_year: 1860, end_year: 2014}
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: NorESM2-LM,     exp: historical,  ensemble: r1i1p1f1, start_year: 1660, end_year: 1814, }
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: NorESM2-MM,     exp: historical, ensemble: r1i1p1f1, start_year: 1261, end_year: 1415,}
      #     # - {project: CMIP6, mip: Ofx, grid: gn, dataset: SAM0-UNICON,     exp: historical, ensemble: r1i1p1f1, start_year: 284, end_year: 438}
      #     - {project: CMIP6, mip: Ofx, grid: gn, dataset: UKESM1-0-LL,     exp: piControl,  ensemble: r1i1p1f2, start_year: 2175, end_year: 2329}

    scripts:
      diagnostic:
        # script: ocean/diagnostic_chap3_ocean_heat_content.py
        script: ocean/calculate_hist_time_in_picontrol.py # Useful for calculating the time range.
